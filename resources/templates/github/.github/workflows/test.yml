name: SICP Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
      with:
        fetch-depth: 0  # Нужно для git diff

    - name: Install Racket
      uses: Bogdanp/setup-racket@v1.11
      with:
        version: 8.11

    - name: Run tests
      run: |
        chmod +x scripts/test-exercises.sh
        ./scripts/test-exercises.sh
      env:
        GITHUB_EVENT_NAME: ${{ github.event_name }}
        GITHUB_BASE_REF: ${{ github.event.pull_request.base.sha }}
